<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>√Årea do Afiliado - Rifa Pix</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f6fb;
      margin: 0;
      padding: 0;
    }

    header {
      background: #111827;
      color: white;
      padding: 18px;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
    }

    .container {
      max-width: 650px;
      margin: 20px auto;
      padding: 15px;
    }

    .card {
      background: white;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }

    .card h2 {
      margin: 0 0 10px;
      font-size: 16px;
      color: #111827;
    }

    .info {
      font-size: 14px;
      color: #374151;
      margin-bottom: 8px;
    }

    .highlight {
      font-weight: bold;
      color: #0f172a;
    }

    .btn {
      width: 100%;
      border: none;
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 15px;
      font-weight: bold;
      margin-top: 10px;
      transition: 0.2s;
    }

    .btn-primary {
      background: #2563eb;
      color: white;
    }

    .btn-primary:hover {
      background: #1d4ed8;
    }

    .btn-green {
      background: #16a34a;
      color: white;
    }

    .btn-green:hover {
      background: #15803d;
    }

    .btn-dark {
      background: #111827;
      color: white;
    }

    .btn-dark:hover {
      background: #0b1220;
    }

    .box {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      padding: 10px;
      word-break: break-word;
      font-size: 13px;
      margin-top: 8px;
      white-space: pre-line;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }

    .stat {
      background: #f1f5f9;
      border-radius: 12px;
      padding: 12px;
      text-align: center;
      font-size: 14px;
      font-weight: bold;
      color: #111827;
    }

    .stat span {
      display: block;
      margin-top: 5px;
      font-size: 20px;
      color: #2563eb;
    }

    .warning {
      background: #fff7ed;
      border: 1px solid #fdba74;
      padding: 12px;
      border-radius: 10px;
      font-size: 14px;
      color: #9a3412;
      line-height: 1.4;
    }

    .textBlock {
      margin-top: 15px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: #ffffff;
    }

    .textTitle {
      font-weight: bold;
      color: #111827;
      margin-bottom: 6px;
      font-size: 14px;
    }

    footer {
      text-align: center;
      padding: 20px;
      font-size: 12px;
      color: #6b7280;
    }
  </style>
</head>

<body>

  <header>ü§ù √Årea do Afiliado - Rifa Pix</header>

  <div class="container">

    <div class="card">
      <h2>üì± Identifica√ß√£o do Afiliado</h2>
      <div class="info">WhatsApp detectado: <span class="highlight" id="affPhone">---</span></div>
      <div class="info">Status: <span class="highlight" id="affStatus">Carregando...</span></div>
    </div>

    <div class="card">
      <h2>üîó Seu Link de Divulga√ß√£o</h2>

      <div class="info">
        Compartilhe esse link com seus amigos. Quando eles comprarem e o ADM confirmar, voc√™ ganha pontos.
      </div>

      <div class="box" id="affLinkBox">---</div>

      <button class="btn btn-primary" onclick="copyAffiliateLink()">
        üìã Copiar Link
      </button>

      <button class="btn btn-green" onclick="shareAffiliateLink()">
        üì≤ Compartilhar no WhatsApp
      </button>
    </div>

    <div class="card">
      <h2>üìä Seus Resultados</h2>

      <div class="stats">
        <div class="stat">
          Pontos
          <span id="affPoints">0</span>
        </div>

        <div class="stat">
          Indicados Pagos
          <span id="affPaid">0</span>
        </div>

        <div class="stat">
          B√¥nus Ganhos
          <span id="affBonuses">0</span>
        </div>

        <div class="stat">
          Faltam para b√¥nus
          <span id="affMissing">10</span>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>üéÅ Regras do Programa</h2>

      <div class="warning">
        ‚úÖ A cada n√∫mero pago confirmado pelo ADM = <b>+1 ponto</b><br><br>
        üéâ Ao completar <b>10 pontos</b>, voc√™ ganha <b>1 b√¥nus</b><br><br>
        üìå O b√¥nus ser√° entregue pelo administrador (n√∫mero gr√°tis ou pr√™mio definido)
      </div>
    </div>

    <div class="card">
      <h2>üì¢ Textos Prontos para Divulga√ß√£o</h2>
      <div class="info">
        Copie um dos textos abaixo e envie junto com seu link.
      </div>

      <div id="textsArea"></div>
    </div>

  </div>

  <footer>
    Sistema de Afiliados - Rifa Pix Oficial ¬©
  </footer>

  <script>
    function getAffiliateData() {
      return JSON.parse(localStorage.getItem("affiliateData")) || {};
    }

    function getAffiliatePhone() {
      const params = new URLSearchParams(window.location.search);
      const tel = params.get("tel");

      if (tel) return tel.replace(/\D/g, "");

      const saved = localStorage.getItem("currentBuyerPhone");
      return saved ? saved.replace(/\D/g, "") : "";
    }

    function buildAffiliateLink(phone) {
      return window.location.origin + "/rifa-pix/?ref=" + phone;
    }

    function copyText(text, btn) {
      navigator.clipboard.writeText(text).then(() => {
        const original = btn.innerText;
        btn.innerText = "‚úÖ Copiado!";
        btn.disabled = true;

        setTimeout(() => {
          btn.innerText = original;
          btn.disabled = false;
        }, 2000);

      }).catch(() => {
        alert("‚ùå N√£o foi poss√≠vel copiar.");
      });
    }

    function loadAffiliateTexts(link) {
      const texts = [
        {
          title: "Texto 1 (curto e direto)",
          content:
`üéüÔ∏è RIFA PIX OFICIAL
üí∏ Pr√™mio: PIX R$ 50,00
üí∞ Apenas R$ 0,80 por n√∫mero

üëá Garanta j√° o seu:
${link}

üçÄ Boa sorte!`
        },
        {
          title: "Texto 2 (mais chamativo)",
          content:
`üö® ATEN√á√ÉO! üö®
Saiu a RIFA PIX OFICIAL valendo PIX R$ 50,00 üí∏üî•

üéüÔ∏è Cada n√∫mero custa s√≥ R$ 0,80
üìå Escolha direto no site e envia autom√°tico no WhatsApp

üëá Clique e participe agora:
${link}

‚è≥ Corre porque os n√∫meros s√£o limitados!`
        },
        {
          title: "Texto 3 (para grupos do WhatsApp)",
          content:
`üì¢ RIFA PIX OFICIAL üì¢

üí∞ Pr√™mio: PIX R$ 50,00
üéüÔ∏è N√∫mero: R$ 0,80

üìå Escolha seus n√∫meros e concorra!

üëá Link para participar:
${link}

üî• Quem vai levar esse PIX?`
        },
        {
          title: "Texto 4 (estilo amigo indicando)",
          content:
`Falaaa üòÑüî•

T√¥ participando de uma rifa valendo PIX R$ 50,00 e o n√∫mero √© s√≥ R$ 0,80.

Se quiser participar tamb√©m, entra por aqui:
${link}

üçÄ Boa sorte!`
        }
      ];

      const area = document.getElementById("textsArea");
      area.innerHTML = "";

      texts.forEach((t, index) => {
        const div = document.createElement("div");
        div.className = "textBlock";

        div.innerHTML = `
          <div class="textTitle">${t.title}</div>
          <div class="box" id="textBox${index}">${t.content}</div>
          <button class="btn btn-dark" id="btnCopy${index}">
            üìã Copiar Texto
          </button>
        `;

        area.appendChild(div);

        setTimeout(() => {
          const btn = document.getElementById("btnCopy" + index);
          btn.onclick = () => copyText(t.content, btn);
        }, 10);
      });
    }

    function loadAffiliatePanel() {
      const phone = getAffiliatePhone();
      const data = getAffiliateData();

      const affPhone = document.getElementById("affPhone");
      const affStatus = document.getElementById("affStatus");
      const affLinkBox = document.getElementById("affLinkBox");

      const affPoints = document.getElementById("affPoints");
      const affPaid = document.getElementById("affPaid");
      const affBonuses = document.getElementById("affBonuses");
      const affMissing = document.getElementById("affMissing");

      if (!phone || phone.length < 10) {
        affPhone.innerText = "---";
        affStatus.innerText = "‚ùå Nenhum WhatsApp identificado";
        affLinkBox.innerText = "Informe seu WhatsApp comprando pelo site antes.";
        return;
      }

      affPhone.innerText = phone;
      affStatus.innerText = "‚úÖ Afiliado ativo";

      const link = buildAffiliateLink(phone);
      affLinkBox.innerText = link;

      const affiliate = data[phone] || {
        points: 0,
        totalPaid: 0,
        bonuses: 0
      };

      affPoints.innerText = affiliate.points;
      affPaid.innerText = affiliate.totalPaid;
      affBonuses.innerText = affiliate.bonuses;

      const missing = 10 - affiliate.points;
      affMissing.innerText = missing;

      // carregar textos prontos
      loadAffiliateTexts(link);
    }

    function copyAffiliateLink() {
      const phone = getAffiliatePhone();

      if (!phone || phone.length < 10) {
        alert("‚ö†Ô∏è Nenhum WhatsApp encontrado para gerar link.");
        return;
      }

      const link = buildAffiliateLink(phone);

      navigator.clipboard.writeText(link).then(() => {
        alert("‚úÖ Link copiado com sucesso!\n\n" + link);
      }).catch(() => {
        alert("‚ùå N√£o foi poss√≠vel copiar.");
      });
    }

    function shareAffiliateLink() {
      const phone = getAffiliatePhone();

      if (!phone || phone.length < 10) {
        alert("‚ö†Ô∏è Nenhum WhatsApp encontrado para gerar link.");
        return;
      }

      const link = buildAffiliateLink(phone);

      const msg =
        "üî• Participe da RIFA PIX OFICIAL!\n\n" +
        "üéüÔ∏è Pr√™mio: PIX R$ 50,00\n" +
        "üí∞ N√∫mero: R$ 0,80\n\n" +
        "üëá Acesse pelo link:\n" +
        link;

      window.open("https://wa.me/?text=" + encodeURIComponent(msg), "_blank");
    }

    window.addEventListener("load", loadAffiliatePanel);
  </script>

</body>
  </html>
  
